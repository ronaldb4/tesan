## Introduction

This project is principally a refactoring of the code found at 
https://github.com/Xueping/tesan. This code was provided 
as support for [the paper "Temporal Self-Attention Network for Medical Concept Embedding"](https://ieeexplore.ieee.org/abstract/document/8970822?casa_token=Q_SWfa9NTwsAAAAA:IUafx0x8lOSblA3V7HcFVRO9F5ruk7p8XUyhAzTv00qGqCdPRrFnIU9ZWQfqX0snGqbdwWe96w) 
authored by Xueping Peng; Guodong Long; Tao Shen; Sen Wang; Jing Jiang; Michael Blumenstein 

The purpose of the paper is to present a new embedding method that accommodates the 
temporal aspect of medical data (visits and their diagnoses, procedures). The goal of
this new method is to produced improved embeddings for building machine learning algorithms.


## This Project
The goal of the refactor is to make clearer the purposes and difference between the 
assorted models presented in the paper.

Within the paper, nine (9) models are discussed:

- The proposed model
  - TeSAN
- Five (5) baseline models
  - CBOW
  - Skip-Gram
  - GloVe
  - med2vec
  - MCE
- Three (3) ablation models
  - Normal Self-Attention
  - Interval
  - Multiple Self-Attention

Of the nine (9) models discussed in the paper, the original code provides for executing the proposed model, CBOW and the 3 ablation models.

In addition to these models, the original code also specifies three (3) additional models:
- TeSA
- TA_attn
- Fusion 
These additional models are represented in the refactor, however (with the exception of TeSA) they have not been tested/executed.

Beyond generating embeddings, the original code provides for creating mortality 
prediction models based upon the embeddings generated by the nine discussed models. The 
purpose is not to create effective prediction models, but as an additional test to  
demonstrate the benefit of the proposed embedding mechanism.

#### Executing the Code

To generate embeddings for a given model, the **train_embedding.py** file 
in **src/concept_embedding** directory should be executed passing 2 parameters:
- model
- configSet

The **model** parameter specifies the model being used to generate embedings. The supported/tested
options are:

| Parameter Value | Model |
|-----------------| ----- |
| tesan           | TeSAN |
| cbow            | CBOW |
| sa              | Multiple Self-Attention |
| delta           | Interval |
| multi           | Multiple Self-Attention |
| tesa | TeSA |

The **configSet** parameter specifies the JSON file to be used (examples are provided). This file specifies the 
hyper-parameters define the behavior of the both the model and the treatment of the data.

To generate the mortality prediction models, the **train_prediction.py** file in 
**src/mortaility_prediction** should be executed. It supports and requires the same
as **train_embedding.py** * *(the configSet is slightly different in the supported options - 
examples are provided)* *

   
